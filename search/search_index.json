{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"ATCC Cyber Legends Knowledge Base","text":"<p>Welcome to the central command for the Alexandria Tech CCDC Team.</p>"},{"location":"#quick-actions","title":"Quick Actions","text":"<ul> <li>Start here (Triage) - Start here when the competition begins.</li> <li>Linux Hardening - Hardening scripts for Linux.</li> <li>Windows Hardening - Hardening scripts for Windows.</li> <li>Service Self-Check - Run this to verify scoring.</li> </ul>"},{"location":"#repository-status","title":"Repository Status","text":"<ul> <li>Maintainer: DrGopher9</li> <li>Last Update: Final Competition Prep</li> </ul>      ATCC Cyber Legends \u00a9 2025      .      \u00a0\u00a0|\u00a0\u00a0      ..      ATCC Cyber Legends \u00a9 2025      .      \u00a0\u00a0|\u00a0\u00a0      .."},{"location":"applocker/","title":"AppLocker (Windows Application Whitelisting)","text":"<p>Goal: Stop \"portable\" malware (EXEs running from Desktop/Downloads). Target: Windows 11 Workstation &amp; Servers.</p>"},{"location":"applocker/#1-start-the-service","title":"1. Start the Service","text":"<p>AppLocker won't work if this service is off. * PowerShell: <code>Set-Service -Name \"AppIDSvc\" -StartupType Automatic; Start-Service \"AppIDSvc\"</code></p>"},{"location":"applocker/#2-configure-the-policy-local-group-policy","title":"2. Configure the Policy (Local Group Policy)","text":"<ol> <li>Run <code>gpedit.msc</code>.</li> <li>Go to: Computer Configuration -&gt; Windows Settings -&gt; Security Settings -&gt; Application Control Policies -&gt; AppLocker.</li> <li>Executable Rules:<ul> <li>Right-click -&gt; Create Default Rules.</li> <li>This automatically allows C:\\Windows and C:\\Program Files.</li> <li>CRITICAL: If you skip this, you will crash the OS.</li> </ul> </li> <li>Enforce It:<ul> <li>Click AppLocker (top level).</li> <li>Click Configure Rule Enforcement.</li> <li>Check Executable rules -&gt; Set to Enforce rules.</li> </ul> </li> </ol>"},{"location":"applocker/#3-the-panic-button-if-you-lock-yourself-out","title":"3. The \"Panic Button\" (If you lock yourself out)","text":"<p>If legitimate programs stop working: 1.  Open <code>gpedit.msc</code>. 2.  Go back to Configure Rule Enforcement. 3.  Change it to Audit only. 4.  Run <code>gpupdate /force</code> in cmd.</p>"},{"location":"applocker/#4-script-to-enable-via-powershell-fast-mode","title":"4. Script to Enable via PowerShell (Fast Mode)","text":"<p>Run this to turn on default rules instantly.</p> <p>```powershell Import-Module AppLocker Set-AppLockerPolicy -XmlPolicy (Get-AppLockerPolicy -Effective -Xml) -Merge</p>"},{"location":"applocker/#note-configuring-via-gui-is-safer-for-beginners","title":"(Note: Configuring via GUI is safer for beginners)","text":""},{"location":"exploits/","title":"Common Exploits &amp; Vulnerabilities","text":"<p>Know what the Red Team is throwing at you.</p>"},{"location":"exploits/#windows-exploits","title":"Windows Exploits","text":"<ul> <li>EternalBlue (MS17-010):<ul> <li>Target: SMBv1 (Port 445).</li> <li>Fix: Disable SMBv1 immediately. Patch Windows.</li> </ul> </li> <li>PrintNightmare:<ul> <li>Target: Print Spooler Service.</li> <li>Fix: Disable the Print Spooler on all Domain Controllers.</li> </ul> </li> <li>Mimikatz (Credential Dumping):<ul> <li>Target: LSASS memory.</li> <li>Fix: Enable \"LSA Protection\" in Registry. Don't log in as Domain Admin on infected boxes.</li> </ul> </li> </ul>"},{"location":"exploits/#linux-exploits","title":"Linux Exploits","text":"<ul> <li>DirtyCOW (Privilege Escalation):<ul> <li>Target: Old Linux Kernels.</li> <li>Fix: Update the kernel (<code>yum update kernel</code> or <code>apt upgrade</code>).</li> </ul> </li> <li>Path Manipulation:<ul> <li>Target: User relying on relative paths.</li> <li>Fix: Never run scripts as <code>./script</code>. Always use full paths <code>/home/user/script</code>.</li> </ul> </li> <li>Cron Job Persistence:<ul> <li>Target: Hidden malicious tasks.</li> <li>Fix: Audit <code>/etc/crontab</code> and <code>/var/spool/cron</code>.</li> </ul> </li> </ul>"},{"location":"exploits/#web-exploits","title":"Web Exploits","text":"<ul> <li>SQL Injection:<ul> <li>Target: Login forms (e.g., <code>' OR 1=1 --</code>).</li> <li>Fix: Input validation (tough to fix in CCDC code, better to use a WAF/Firewall).</li> </ul> </li> <li>Web Shells:<ul> <li>Target: PHP files uploaded to web directories.</li> <li>Fix: Disable file uploads in <code>php.ini</code> (<code>file_uploads = Off</code>).</li> </ul> </li> </ul>"},{"location":"injects/","title":"Common Injects &amp; Business Tasks","text":"<p>Goal: Complete these professionally and quickly. Always turn them in as a PDF unless told otherwise.</p>"},{"location":"injects/#1-the-password-policy-inject","title":"1. The \"Password Policy\" Inject","text":"<p>You will almost always be asked to write a password policy in the first hour.</p> <p>Template:</p> <p>To: Management From: IT Security Team Subject: Updated Password Security Standards</p> <p>Effective immediately, the following password standards are enforced to secure company assets: 1.  Length: Minimum 12 characters. 2.  Complexity: Must contain Upper, Lower, Number, and Special Character. 3.  History: Cannot reuse the last 5 passwords. 4.  Age: Passwords expire every 90 days. 5.  Lockout: Account locks after 5 failed attempts for 15 minutes.</p>"},{"location":"injects/#2-the-incident-report-inject","title":"2. The \"Incident Report\" Inject","text":"<p>Task: Report on a breach you found (e.g., Red Team changed a wallpaper).</p> <p>Template: * Incident Time: [Insert Date/Time] * Affected Systems: [IP Addresses / Hostnames] * Description: We detected unauthorized access via [SSH/RDP/Web]. The attacker exploited a default credential. * Action Taken:     * The attacker's IP was blocked at the firewall.     * The compromised account was locked.     * Credentials have been reset. * Status: Systems are currently stable and being monitored.</p>"},{"location":"injects/#3-the-new-user-inject","title":"3. The \"New User\" Inject","text":"<p>Task: Create a new user 'JSmith' with specific permissions.</p> <p>Linux Command: <pre><code>useradd -m -s /bin/bash jsmith\npasswd jsmith\n# If they need sudo/admin rights:\nusermod -aG sudo jsmith\n</code></pre></p> <p>Windows Command: <pre><code>New-LocalUser -Name \"jsmith\" -NoPassword\nSet-LocalUser -Name \"jsmith\" -Password (Read-Host -AsSecureString)\nAdd-LocalGroupMember -Group \"Users\" -Member \"jsmith\"\n</code></pre></p>"},{"location":"injects/#4-the-user-audit-inject","title":"4. The \"User Audit\" Inject","text":"<p>Task: Identify all users and find who needs a password change.</p> <p>Linux (Find old passwords): * <code>chage -l [username]</code> (Shows when password was last changed) * <code>cut -d: -f1,3 /etc/shadow</code> (Shows username and date of last change)</p> <p>Windows (Find bad passwords): * Run this PowerShell command to see who hasn't changed their password recently:     <pre><code>Get-LocalUser | Select-Object Name, PasswordLastSet, Enabled\n</code></pre></p>"},{"location":"inventory/","title":"Systems &amp; Credentials Inventory","text":"<p>WARNING: These are the DEFAULT credentials. Change them immediately.</p>"},{"location":"inventory/#left-side-palo-alto-network","title":"\"Left Side\" (Palo Alto Network)","text":"<p>Protected by Palo Alto Firewall</p> VM Name OS IP Address Default Creds Palo Alto FW PAN-OS 10.2 <code>172.20.242.150</code> (Mgmt) <code>admin</code> / <code>Changeme123</code> Ecom Ubuntu 24.04 <code>172.20.242.104</code> <code>sysadmin</code> / <code>changeme</code> Webmail Fedora 42 <code>172.20.242.101</code> <code>sysadmin</code> / <code>changeme</code> Splunk Oracle Linux 9 <code>172.20.242.20</code> <code>root</code> / <code>changemenow</code><code>admin</code> / <code>changeme</code> Wkst (Linux) Ubuntu 24.04 Dynamic (DHCP) <code>sysadmin</code> / <code>changeme</code>"},{"location":"inventory/#right-side-cisco-ftd-network","title":"\"Right Side\" (Cisco FTD Network)","text":"<p>Protected by Cisco FTD Firewall</p> VM Name OS IP Address Default Creds Cisco FTD FTD 7.2.9 <code>172.20.240.200</code> (Mgmt) <code>admin</code> / <code>!Changeme123</code> AD / DNS Server 2019 <code>172.20.240.102</code> <code>administrator</code> / <code>Password123</code> Web Server 2019 <code>172.20.240.101</code> <code>administrator</code> / <code>Password123</code> FTP Server 2022 <code>172.20.240.104</code> <code>administrator</code> / <code>Password123</code> Wkst (Win) Win 11 24H2 <code>172.20.240.100</code> <code>UserOne</code> / <code>ChangeMe123</code><code>administrator</code> / <code>Password123</code>"},{"location":"inventory/#core-router","title":"Core Router","text":"VM Name OS IP Address Default Creds VyOS Router VyOS 1.4.3 Gateway <code>vyos</code> / <code>changeme</code>"},{"location":"linux/","title":"Linux Hardening (Ubuntu &amp; Red Hat)","text":"<p>Goal: Secure the box without breaking scoring services.</p>"},{"location":"linux/#1-quick-distro-check","title":"1. Quick Distro Check","text":"<p>Not sure what OS you are on? Run this: <code>cat /etc/os-release</code></p>"},{"location":"linux/#2-universal-hardening-all-distros","title":"2. Universal Hardening (All Distros)","text":"<p>These commands work on Ubuntu, Fedora, and Oracle.</p>"},{"location":"linux/#user-management","title":"User Management","text":"<ul> <li>Lock Root: <code>sudo passwd -l root</code></li> <li>Lock Suspicious User: <code>sudo passwd -l [username]</code></li> <li>Find Empty Passwords: <code>awk -F: '($2 == \"\") {print}' /etc/shadow</code></li> </ul>"},{"location":"linux/#ssh-config-etcsshsshd_config","title":"SSH Config (<code>/etc/ssh/sshd_config</code>)","text":"<ul> <li>Disable Root Login: Change to <code>PermitRootLogin no</code></li> <li>Disable Empty Passwords: Change to <code>PermitEmptyPasswords no</code></li> <li>Restart SSH: <code>sudo systemctl restart sshd</code></li> </ul>"},{"location":"linux/#audit-persistence","title":"Audit Persistence","text":"<ul> <li>Check Cron: <code>crontab -l</code> and <code>cat /etc/crontab</code></li> <li>Check Sudoers: <code>visudo</code> (Look for <code>NOPASSWD</code> lines!)</li> </ul>"},{"location":"linux/#3-the-red-hat-family-fedora-oracle-9-centos","title":"3. The \"Red Hat\" Family (Fedora, Oracle 9, CentOS)","text":"<p>Used for: Webmail, Splunk</p>"},{"location":"linux/#package-manager-dnf-yum","title":"Package Manager: DNF / YUM","text":"<ul> <li>Update System: <code>sudo dnf update --security</code></li> <li>Install Tools: <code>sudo dnf install nmap tmux</code></li> <li>Remove Tools: <code>sudo dnf remove netcat nc</code></li> </ul>"},{"location":"linux/#firewall-firewalld-crucial","title":"Firewall: FirewallD (Crucial!)","text":"<p>Red Hat does NOT use UFW. It uses FirewallD. * Check Status: <code>systemctl status firewalld</code> * Allow Service (Temporary): <code>firewall-cmd --add-service=http</code> * Allow Port (Permanent): <code>firewall-cmd --permanent --add-port=80/tcp</code> * Block IP: <code>firewall-cmd --permanent --add-rich-rule=\"rule family='ipv4' source address='1.2.3.4' reject\"</code> * Apply Changes: <code>firewall-cmd --reload</code> * Panic Mode (Stop Firewall): <code>systemctl stop firewalld</code></p>"},{"location":"linux/#selinux-the-shield","title":"SELinux (The \"Shield\")","text":"<ul> <li>Check Status: <code>sestatus</code> (Should say \"Enforcing\")</li> <li>Turn On: <code>setenforce 1</code></li> <li>Note: If services break, check logs: <code>tail -f /var/log/audit/audit.log</code></li> </ul>"},{"location":"linux/#4-the-debian-family-ubuntu-24","title":"4. The \"Debian\" Family (Ubuntu 24)","text":"<p>Used for: Ecom, Workstations</p>"},{"location":"linux/#package-manager-apt","title":"Package Manager: APT","text":"<ul> <li>Update System: <code>sudo apt update &amp;&amp; sudo apt upgrade</code></li> <li>Install Tools: <code>sudo apt install nmap</code></li> </ul>"},{"location":"linux/#firewall-ufw-uncomplicated-firewall","title":"Firewall: UFW (Uncomplicated Firewall)","text":"<ul> <li>Status: <code>sudo ufw status verbose</code></li> <li>Allow SSH: <code>sudo ufw allow ssh</code> (DO THIS FIRST)</li> <li>Allow Web: <code>sudo ufw allow 80/tcp</code></li> <li>Block IP: <code>sudo ufw deny from 1.2.3.4</code></li> <li>Enable: <code>sudo ufw enable</code></li> </ul>"},{"location":"linux/#5-service-control-systemd","title":"5. Service Control (Systemd)","text":"<p>Works on ALL your Linux machines.</p> <ul> <li>List Running Services: <code>systemctl list-units --type=service --state=running</code></li> <li>Stop a Service: <code>sudo systemctl stop [service_name]</code></li> <li>Disable (Prevent Start): <code>sudo systemctl disable [service_name]</code></li> </ul>"},{"location":"networking/","title":"Network Defense (VyOS, Palo Alto, FTD)","text":"<p>Topology Overview: * Top: VyOS Router (Gateway) * Left Side: Palo Alto Firewall (Protecting Linux/Splunk) * Right Side: Cisco FTD Firewall (Protecting Windows/AD)</p>"},{"location":"networking/#1-vyos-router-the-gateway","title":"1. VyOS Router (The Gateway)","text":"<p>VyOS uses \"Juniper-style\" syntax. Changes are not active until you COMMIT.</p> <ul> <li>Enter Config Mode: <code>configure</code></li> <li>Show Configuration: <code>show configuration</code></li> <li>Set IP Address: <code>set interfaces ethernet eth0 address 10.0.0.1/24</code></li> <li>Static Route: <code>set protocols static route 0.0.0.0/0 next-hop [Next_Hop_IP]</code></li> <li>NAT (Masquerade/Outbound): <code>set nat source rule 100 outbound-interface 'eth0'</code> <code>set nat source rule 100 source address '192.168.1.0/24'</code> <code>set nat source rule 100 translation address 'masquerade'</code></li> <li>APPLY CHANGES (Crucial): <code>commit</code> <code>save</code></li> </ul>"},{"location":"networking/#2-palo-alto-firewall-left-side","title":"2. Palo Alto Firewall (Left Side)","text":"<p>Protecting: Ecom, Webmail, Splunk, Linux Workstation</p>"},{"location":"networking/#access-details","title":"Access Details","text":"<ul> <li>[cite_start]Management IP: <code>172.20.242.150</code> [cite: 253]</li> <li>[cite_start]Credentials: <code>admin</code> / <code>Changeme123</code> [cite: 254]</li> <li>How to Access:<ul> <li>[cite_start]GUI: Open Firefox on the Ubuntu Workstation and browse to <code>https://172.20.242.150</code>[cite: 253].</li> <li>CLI: SSH to <code>172.20.242.150</code> or use the Netlab Console.</li> </ul> </li> </ul>"},{"location":"networking/#critical-commands-cli","title":"Critical Commands (CLI)","text":"<ul> <li>View Interfaces: <code>show interface logical</code></li> <li>View Active Sessions: <code>show session all</code></li> <li>View Security Rules: <code>show running security-policy</code></li> <li>Commit Changes (CLI): <code>configure</code> <code># [Type your set commands here]</code> <code>commit</code></li> </ul>"},{"location":"networking/#3-cisco-ftd-right-side","title":"3. Cisco FTD (Right Side)","text":"<p>Protecting: AD/DNS, Web Server, FTP, Windows Workstation</p>"},{"location":"networking/#access-details_1","title":"Access Details","text":"<ul> <li>[cite_start]Management IP: <code>172.20.240.200</code> [cite: 256]</li> <li>[cite_start]Credentials: <code>admin</code> / <code>!Changeme123</code> [cite: 257, 258]</li> <li>How to Access (CRITICAL):<ul> <li>GUI: You MUST use the Windows 11 Workstation.</li> <li>[cite_start]URL: Browse to <code>https://172.20.102.254/#/login</code>[cite: 260].</li> <li>Note: The PDF specifies this odd IP <code>102.254</code> for GUI access from the workstation.</li> </ul> </li> </ul>"},{"location":"networking/#troubleshooting-cli","title":"Troubleshooting (CLI)","text":"<p>This is NOT a standard ASA. You must drop into diagnostic mode.</p> <ul> <li>Enter the Diagnostic CLI:<ol> <li>Login to the console (<code>admin</code> / <code>!Changeme123</code>).</li> <li>Type: <code>system support diagnostic-cli</code></li> <li>Type: <code>enable</code></li> <li>(You are now in a standard Cisco ASA-style prompt).</li> </ol> </li> <li>Packet Tracer (The #1 Troubleshooting Tool):<ul> <li>Use this to see EXACTLY why traffic is failing.</li> <li><code>packet-tracer input [Interface_Name] tcp [Src_IP] 12345 [Dst_IP] 80</code></li> </ul> </li> </ul>"},{"location":"networking/#4-host-based-firewalls-know-your-os","title":"4. Host-Based Firewalls (Know Your OS!)","text":""},{"location":"networking/#left-side-the-linux-mix","title":"Left Side (The Linux Mix)","text":"<ul> <li>Ubuntu 24 (Ecom &amp; Wkst):<ul> <li>Uses UFW.</li> <li>Allow SSH: <code>ufw allow 22/tcp</code></li> <li>Enable: <code>ufw enable</code></li> </ul> </li> <li>Fedora 42 (Webmail) &amp; Oracle 9 (Splunk):<ul> <li>These do NOT use UFW. They use FirewallD.</li> <li>Check status: <code>systemctl status firewalld</code></li> <li>Open Port 80: <code>firewall-cmd --add-port=80/tcp --permanent</code></li> <li>Apply changes: <code>firewall-cmd --reload</code></li> <li>Emergency Stop: <code>systemctl stop firewalld</code></li> </ul> </li> </ul>"},{"location":"networking/#right-side-the-windows-mix","title":"Right Side (The Windows Mix)","text":"<ul> <li>Server 2019/2022 &amp; Win 11:<ul> <li>Uses Windows Firewall.</li> <li>Use the PowerShell commands found in the Windows Hardening page.</li> </ul> </li> </ul>"},{"location":"schedule/","title":"Competition Schedule (Times are CST)","text":"<p>CRITICAL: Be logged into the NISE Portal (Scoreboard) 30 minutes before the start time.</p>"},{"location":"schedule/#saturday-oct-18-afternoon-section","title":"Saturday, Oct 18 (Afternoon Section)","text":"<ul> <li>[cite_start]12:30 PM: Teams Join Zoom &amp; Login to NISE (<code>ccdcadmin3.morainevalley.edu</code>) [cite: 302]</li> <li>[cite_start]1:00 PM: DROP FLAG (Access to Systems Granted) [cite: 302]</li> <li>[cite_start]1:00 PM - 5:00 PM: ACTIVE SCORING (Services must be up!) [cite: 302]</li> <li>[cite_start]5:00 PM: Closing &amp; Wrap-up [cite: 302]</li> </ul>"},{"location":"schedule/#saturday-oct-25-morning-section","title":"Saturday, Oct 25 (Morning Section)","text":"<ul> <li>[cite_start]7:00 AM: Teams Join Zoom [cite: 305]</li> <li>[cite_start]7:30 AM: Login to NISE (<code>ccdcadmin1.morainevalley.edu</code>) [cite: 305]</li> <li>[cite_start]8:00 AM: DROP FLAG (Access to Systems Granted) [cite: 305]</li> <li>[cite_start]8:00 AM - 12:00 PM: ACTIVE SCORING [cite: 305]</li> <li>[cite_start]12:00 PM: Closing &amp; Wrap-up [cite: 305]</li> </ul>"},{"location":"schedule/#saturday-nov-1-morning-section","title":"Saturday, Nov 1 (Morning Section)","text":"<ul> <li>[cite_start]7:00 AM: Teams Join Zoom [cite: 322]</li> <li>[cite_start]7:30 AM: Login to NISE [cite: 323]</li> <li>[cite_start]8:00 AM: DROP FLAG [cite: 329]</li> <li>[cite_start]8:00 AM - 12:00 PM: ACTIVE SCORING [cite: 330]</li> </ul> <p>[cite_start]Note: \"Teams should avoid submitting inject responses in the last minute of validity.\" [cite: 134]</p>"},{"location":"splunk/","title":"Splunk Hunting Cheat Sheet","text":"<p>Goal: Don't just collect logs. Find the bad guys. Time Range: Always set to \"Last 15 minutes\" for real-time hunting.</p>"},{"location":"splunk/#1-the-who-is-logging-in-query-sshrdp","title":"1. The \"Who is Logging In?\" Query (SSH/RDP)","text":"<p>Finds brute force attacks or successful logins from weird IPs.</p> <p><pre><code>index=* sourcetype=\"linux_secure\" OR sourcetype=\"WinEventLog:Security\"\n| search \"Failed password\" OR \"EventCode=4625\"\n| stats count by src_ip, user\n| sort - count\n</code></pre> * What to look for: High counts (Brute force). * Refinement (Show me SUCCESSFUL logins only): <code>index=* \"Accepted password\" OR \"EventCode=4624\"</code></p>"},{"location":"splunk/#2-the-new-user-query","title":"2. The \"New User\" Query","text":"<p>Did Red Team just create a backdoor account?</p> <pre><code>index=* (useradd OR \"EventCode=4720\")\n| table _time, user, src_user, dest\n</code></pre>"},{"location":"splunk/#3-the-sudo-abuse-query","title":"3. The \"Sudo Abuse\" Query","text":"<p>Who is running commands as root?</p> <pre><code>index=* sourcetype=\"linux_secure\" \"COMMAND=\"\n| table _time, user, command\n</code></pre>"},{"location":"splunk/#4-the-process-hunter-windows","title":"4. The \"Process Hunter\" (Windows)","text":"<p>Requires Sysmon. Finds dangerous commands like PowerShell or cmd.exe.</p> <pre><code>index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1\n| search CommandLine=\"*powershell*\" OR CommandLine=\"*cmd.exe*\" OR CommandLine=\"*net user*\"\n| table _time, User, CommandLine, ParentCommandLine\n</code></pre>"},{"location":"splunk/#5-the-clear-logs-query-the-smoking-gun","title":"5. The \"Clear Logs\" Query (The Smoking Gun)","text":"<p>If this happens, you are 100% owned.</p> <pre><code>index=* (EventCode=1102 OR \"clcevent\" OR \"rm /var/log\")\n</code></pre>"},{"location":"splunk/#6-firewall-blocks-palo-altoftd","title":"6. Firewall Blocks (Palo Alto/FTD)","text":"<p>See what is hitting your firewall.</p> <pre><code>index=* sourcetype=\"pan:traffic\" OR sourcetype=\"cisco:ftd\" action=\"blocked\"\n| stats count by src_ip, dest_port\n| sort - count\n</code></pre>"},{"location":"strategy/","title":"Scoring Strategy &amp; Rules","text":"<p>The Formula: 50% Tech (Services) + 50% Business (Injects) = Win.</p>"},{"location":"strategy/#1-the-open-source-rule-critical","title":"1. The \"Open Source\" Rule (CRITICAL)","text":"<ul> <li>[cite_start]Rule: You CANNOT install \"Free Trials\" of commercial software (e.g., Norton, CrowdStrike Trial). [cite: 411]</li> <li>[cite_start]Allowed: Only \"Free or Open Source\" software. [cite: 410]</li> <li>Safe List: ClamAV, Notepad++, Wireshark, Putty, LibreOffice.</li> </ul>"},{"location":"strategy/#2-scoring-breakdown","title":"2. Scoring Breakdown","text":"<ul> <li>[cite_start]Services (35-50%): Uptime of Web, Email, DNS. [cite: 464]</li> <li>[cite_start]Injects (35-50%): Business tasks submitted as PDF. [cite: 464]<ul> <li>Strategy: Assign one person as the \"Inject Manager.\" Their ONLY job is to write PDFs and submit them. Never ignore an inject to fix a firewall.</li> </ul> </li> <li>[cite_start]Red Team/Incident Response (10-20%): [cite: 464]<ul> <li>[cite_start]You get points for filing \"Incident Reports\" when you get hacked. [cite: 456]</li> <li>Use the template in the <code>Common Injects</code> page.</li> </ul> </li> </ul>"},{"location":"strategy/#3-the-death-minute","title":"3. \"The Death Minute\"","text":"<ul> <li>[cite_start]Rule: \"Teams should avoid submitting inject responses in the last minute.\" [cite: 134]</li> <li>Strategy: Submit 5 minutes early. The scoring server will lag.</li> </ul>"},{"location":"triage/","title":"CRITICAL: Triage (First 15 Mins)","text":"<p>!!! RULES OF ENGAGEMENT WARNING !!! 1. NO SNAPSHOTS: If you lock yourself out, the VM is dead. [cite_start]Do not apply \"Default Deny\" until you verify access. 2. NO IP BLOCKING: You must allow public services from ALL IPs. [cite_start]Do not whitelist \"only my team\". 3. [cite_start]PING IS REQUIRED: Do not block ICMP (Ping) on the firewall[cite: 413].</p>"},{"location":"triage/#1-stop-the-bleeding-the-golden-4","title":"1. STOP THE BLEEDING (The \"Golden 4\")","text":"<p>Execute these immediately. Do not wait for permission.</p>"},{"location":"triage/#linux-any-distro","title":"Linux (Any Distro)","text":"<ol> <li>Change Root Pass: <code>passwd</code></li> <li>Find Nasty Users (UID 0): <code>grep :0: /etc/passwd</code> (If you see anything other than <code>root</code>, kill it)</li> <li>Block Inbound Traffic (Save SSH): <code>iptables -P INPUT DROP</code> <code>iptables -A INPUT -p tcp --dport 22 -j ACCEPT</code> <code>iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT</code></li> <li>Spot Beacons: <code>ss -tulpn</code> (Look for weird high ports like 4444, 6666, 1337)</li> </ol>"},{"location":"triage/#windows-powershell","title":"Windows (PowerShell)","text":"<ol> <li>Change Admin Pass: <code>net user Administrator \"Sup3rH@rdP@ss!99\"</code></li> <li>Enable Firewall: <code>Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True</code></li> <li>Check Current Admins: <code>Get-LocalGroupMember -Group \"Administrators\"</code></li> <li>See Running Connections: <code>netstat -ano | findstr ESTABLISHED</code></li> </ol>"},{"location":"triage/#2-persistence-hunting","title":"2. PERSISTENCE HUNTING","text":"<p>Red Team usually hides here.</p>"},{"location":"triage/#linux-locations","title":"Linux Locations","text":"<ul> <li><code>crontab -l</code> (Check current user tasks)</li> <li><code>cat /etc/crontab</code> (Check system tasks)</li> <li><code>ls -al /var/www/html</code> (Web shells often look like <code>shell.php</code>)</li> <li><code>ls -lt /tmp/</code> (Look for recent files dropped in temp)</li> </ul>"},{"location":"triage/#windows-locations","title":"Windows Locations","text":"<ul> <li>Startup Folder: <code>shell:startup</code> (Type this in Run box <code>Win+R</code>)</li> <li>Scheduled Tasks: <code>Get-ScheduledTask | Where State -eq 'Ready'</code></li> <li>Registry Run Keys: <code>Get-ItemProperty HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code></li> </ul>"},{"location":"triage/#3-oh-snap-recovery","title":"3. \"OH SNAP\" RECOVERY","text":"<p>If you lock yourself out, type this to reset.</p> <ul> <li>Linux Firewall Flush: <code>iptables -F</code> <code>iptables -P INPUT ACCEPT</code></li> <li>Windows Firewall Off: <code>Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False</code></li> </ul>"},{"location":"windows/","title":"Windows Hardening Guide","text":"<p>Goal: Lock down the domain and local accounts using PowerShell.</p>"},{"location":"windows/#1-user-security-the-basics","title":"1. User Security (The Basics)","text":"<ul> <li>Change Local Administrator Password: <code>net user Administrator \"NewStrongPass!123\"</code></li> <li>Disable Guest Account: <code>net user Guest /active:no</code></li> <li>Audit Administrators Group (Who is boss?): <code>Get-LocalGroupMember -Group \"Administrators\"</code><ul> <li>Remove anyone who doesn't belong: <code>Remove-LocalGroupMember -Group \"Administrators\" -Member \"SuspiciousUser\"</code></li> </ul> </li> </ul>"},{"location":"windows/#2-firewall-turn-it-on","title":"2. Firewall (Turn it ON)","text":"<p>The Windows Firewall is often disabled by Red Team or default configs.</p> <ul> <li>Enable all profiles: <code>Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True</code></li> <li>Block all inbound traffic (Allow explicit rules only): <code>Set-NetFirewallProfile -Profile Domain,Public,Private -DefaultInboundAction Block</code></li> </ul>"},{"location":"windows/#3-smb-sharing-the-1-vulnerability","title":"3. SMB &amp; Sharing (The #1 Vulnerability)","text":"<p>Disable SMBv1 immediately to stop EternalBlue-style attacks.</p> <ul> <li>Check SMBv1 Status: <code>Get-WindowsOptionalFeature -Online -FeatureName SMB1Protocol</code></li> <li>Disable SMBv1: <code>Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol</code></li> </ul>"},{"location":"windows/#4-services-audit","title":"4. Services Audit","text":"<ul> <li>Find Running Services: <code>Get-Service | Where-Object {$_.Status -eq \"Running\"}</code></li> <li>Stop a Service: <code>Stop-Service -Name \"ServiceName\"</code></li> <li>Disable a Service (Prevent restart): <code>Set-Service -Name \"ServiceName\" -StartupType Disabled</code></li> </ul>"},{"location":"windows/#5-rdp-security","title":"5. RDP Security","text":"<p>Ensure Network Level Authentication (NLA) is required.</p> <ul> <li>Enable NLA (Registry Tweak): <code>(Get-WmiObject -class \"Win32_TSGeneralSetting\" -Namespace root\\cimv2\\terminalservices -Filter \"TerminalName='RDP-Tcp'\").SetUserAuthenticationRequired(1)</code></li> </ul>"},{"location":"services/ad/","title":"Active Directory (AD) Hardening","text":"<p>Goal: Secure the \"Keys to the Kingdom.\" If AD falls, the game is over.</p>"},{"location":"services/ad/#1-attack-surface-reduction-asr","title":"1. Attack Surface Reduction (ASR)","text":"<ul> <li>Disable Print Spooler on Domain Controllers (DCs):<ul> <li>Why: Stops \"PrintNightmare\" exploits.</li> <li>Command: <code>Stop-Service Spooler -Force; Set-Service Spooler -StartupType Disabled</code></li> </ul> </li> <li>Block Internet on DCs:<ul> <li>DCs should never browse the web. Remove the Default Gateway if possible, or block port 80/443 outbound on the firewall.</li> </ul> </li> <li>Remove Adobe/Office from DCs:<ul> <li>Uninstall any software that isn't strictly needed for AD.</li> </ul> </li> </ul>"},{"location":"services/ad/#2-gpo-the-mass-lockdown","title":"2. GPO: The \"Mass Lockdown\"","text":"<p>Create a new Group Policy Object (GPO) linked to the whole domain.</p> <ul> <li>Disable cmd.exe (Prevent easy shells):<ul> <li><code>User Config &gt; Policies &gt; Admin Templates &gt; System &gt; Prevent access to the command prompt</code> -&gt; Enabled</li> </ul> </li> <li>Disable Control Panel:<ul> <li><code>User Config &gt; Policies &gt; Admin Templates &gt; Control Panel &gt; Prohibit access to Control Panel</code> -&gt; Enabled</li> </ul> </li> <li>Enable Audit Logging (Catch them):<ul> <li><code>Computer Config &gt; Policies &gt; Windows Settings &gt; Security Settings &gt; Advanced Audit Policy</code> -&gt; Log Logon/Logoff, Process Creation.</li> </ul> </li> </ul>"},{"location":"services/ad/#3-account-safety","title":"3. Account Safety","text":"<ul> <li>Protect the \"Domain Admins\" Group:<ul> <li>Run <code>Get-ADGroupMember \"Domain Admins\"</code> regularly.</li> <li>There should only be 2-3 users here. Remove everyone else.</li> </ul> </li> <li>KRBTGT Reset (Advanced):<ul> <li>If you suspect a \"Golden Ticket\" attack, you must reset the <code>krbtgt</code> account password twice.</li> </ul> </li> </ul>"},{"location":"services/databases/","title":"Database Hardening (MySQL &amp; PostgreSQL)","text":"<p>Goal: Prevent data exfiltration and unauthorized access.</p>"},{"location":"services/databases/#1-mysql-mariadb-common-on-ecom","title":"1. MySQL / MariaDB (Common on Ecom)","text":"<p>Config File: <code>/etc/mysql/my.cnf</code> or <code>/etc/my.cnf</code></p> <ul> <li>Run the Secure Installation Script (DO THIS FIRST):<ul> <li>Command: <code>sudo mysql_secure_installation</code></li> <li>Answer \"Yes\" to: Remove anonymous users, Disallow root login remotely, Remove test database, Reload privilege tables.</li> </ul> </li> <li>Bind to Localhost (Stop Remote Access):<ul> <li>Edit the config file and find <code>bind-address</code>.</li> <li>Change it to: <code>bind-address = 127.0.0.1</code></li> <li>Restart: <code>sudo systemctl restart mysql</code> (or <code>mariadb</code>)</li> </ul> </li> <li>Audit Users (SQL Console):<ul> <li>Login: <code>mysql -u root -p</code></li> <li>Show users: <code>SELECT User, Host FROM mysql.user;</code></li> <li>Drop bad users: <code>DROP USER 'hacker'@'%';</code></li> <li>Lock root to localhost: <code>RENAME USER 'root'@'%' TO 'root'@'localhost';</code></li> </ul> </li> </ul>"},{"location":"services/databases/#2-postgresql-common-on-webmail","title":"2. PostgreSQL (Common on Webmail)","text":"<p>Config File: <code>/etc/postgresql/[version]/main/postgresql.conf</code> Access Control: <code>/etc/postgresql/[version]/main/pg_hba.conf</code></p> <ul> <li>Restrict Listening Address:<ul> <li>Edit <code>postgresql.conf</code>:</li> <li>Change <code>listen_addresses = '*'</code> to <code>listen_addresses = 'localhost'</code></li> </ul> </li> <li>Restrict Authentication (pg_hba.conf):<ul> <li>This file controls who can connect.</li> <li>Bad (Dangerous): <code>host all all 0.0.0.0/0 trust</code></li> <li>Good (Secure): <code>host all all 127.0.0.1/32 md5</code></li> <li>Note: \"md5\" or \"scram-sha-256\" means \"Ask for a password.\" \"Trust\" means \"Let them in without a password.\"</li> </ul> </li> <li>Restart Service: <code>sudo systemctl restart postgresql</code></li> </ul>"},{"location":"services/databases/#3-general-quick-wins","title":"3. General \"Quick Wins\"","text":"<ul> <li>Change Default Passwords:<ul> <li>If the competition packet says the database password is \"changeme\", CHANGE IT.</li> <li>MySQL: <code>ALTER USER 'root'@'localhost' IDENTIFIED BY 'NewC0mplexP@ss!';</code></li> <li>Postgres: <code>\\password postgres</code></li> </ul> </li> <li>Check for Web Shells in Database:<ul> <li>Red Team sometimes hides code in the DB.</li> <li>Dump data: <code>mysqldump -u root -p --all-databases &gt; db_dump.sql</code></li> <li>Search it: <code>grep \"cmd.exe\" db_dump.sql</code> or <code>grep \"base64\" db_dump.sql</code></li> </ul> </li> </ul>"},{"location":"services/dns/","title":"DNS Hardening (Bind &amp; Windows)","text":"<p>Goal: Prevent Zone Transfers (giving away the network map) and Cache Poisoning.</p>"},{"location":"services/dns/#1-bind9-linux","title":"1. BIND9 (Linux)","text":"<p>Config File: <code>/etc/bind/named.conf.options</code></p> <ul> <li>Restrict Recursion (Don't be an open resolver): <pre><code>allow-recursion { localnets; localhost; };\nallow-query-cache { localnets; localhost; };\n</code></pre></li> <li>Block Zone Transfers (Critical): <pre><code>allow-transfer { none; };\n</code></pre></li> <li>Hide Version: <pre><code>version \"unknown\";\n</code></pre></li> <li>Check Config Syntax: <code>named-checkconf /etc/bind/named.conf</code></li> </ul>"},{"location":"services/dns/#2-windows-dns","title":"2. Windows DNS","text":"<p>Manage via DNS Manager (dnsmgmt.msc)</p> <ul> <li>Disable Zone Transfers:<ol> <li>Right-click the Zone -&gt; Properties.</li> <li>Zone Transfers Tab.</li> <li>Uncheck \"Allow zone transfers\" (Or restrict to specific IPs only).</li> </ol> </li> <li>Disable Recursion (If it's an external server):<ol> <li>Right-click Server Name -&gt; Properties.</li> <li>Advanced Tab.</li> <li>Check \"Disable recursion\" (Only if this server does NOT need to resolve Google/Internet for clients).</li> </ol> </li> <li>Enable Scavenging (Clean up old records):<ol> <li>Right-click Server Name -&gt; Properties.</li> <li>Advanced Tab -&gt; Enable \"Scavenging of stale records\".</li> </ol> </li> </ul>"},{"location":"services/self_check/","title":"Service Self-Check Script","text":"<p>Goal: Run this every 5 minutes to see if you are passing BEFORE the scoreboard updates.</p>"},{"location":"services/self_check/#linux-check-script-run-on-ecom-or-workstation","title":"Linux Check Script (Run on Ecom or Workstation)","text":"<p>Save this file as <code>check_score.sh</code> on your Linux machine and run <code>chmod +x check_score.sh</code> to make it executable.</p> <pre><code>#!/bin/bash\n\n# 1. Check Web Content (Must match original!)\n# If the Red Team defaces your site, grep will fail to find \"Welcome\"\necho \"--- Checking Web Servers ---\"\nif curl -s [http://172.20.240.101](http://172.20.240.101) | grep -q \"Welcome\"; then\n    echo \"[PASS] Windows Web Server Content Match\"\nelse\n    echo \"[FAIL] Windows Web Server (Content Mismatch or Down)\"\nfi\n\n# 2. Check DNS (Must resolve internally)\n# We test if the AD/DNS server (172.20.240.102) can resolve a domain\necho \"--- Checking DNS ---\"\nif nslookup google.com 172.20.240.102 &gt; /dev/null; then\n    echo \"[PASS] Windows DNS is resolving\"\nelse\n    echo \"[FAIL] Windows DNS is DOWN\"\nfi\n\n# 3. Check POP3 &amp; SMTP (Email)\n# The scoring engine logs into AD (172.20.240.102) to check email\necho \"--- Checking Email Ports ---\"\nnc -zv 172.20.240.102 110 &amp;&amp; echo \"[PASS] POP3 Port Open\" || echo \"[FAIL] POP3 Closed\"\nnc -zv 172.20.240.102 25 &amp;&amp; echo \"[PASS] SMTP Port Open\" || echo \"[FAIL] SMTP Closed\"\n</code></pre>"},{"location":"services/web/","title":"Web Server Hardening (Apache, Nginx, IIS)","text":"<p>Goal: Stop information leaks and prevent web shells.</p>"},{"location":"services/web/#1-apache-linux","title":"1. Apache (Linux)","text":"<p>Config File: Usually <code>/etc/apache2/apache2.conf</code> or <code>/etc/httpd/conf/httpd.conf</code></p> <ul> <li>Hide Version Banner (Stop scanners):<ul> <li>Add/Edit these lines: <pre><code>ServerSignature Off\nServerTokens Prod\n</code></pre></li> </ul> </li> <li>Disable Directory Listing (Prevent snooping):<ul> <li>Remove <code>Indexes</code> from the Options line:</li> <li><code>Options -Indexes +FollowSymLinks</code></li> </ul> </li> <li>Disable \"server-status\" (Leak hazard):<ul> <li>Comment out the <code>&lt;Location /server-status&gt;</code> block if found.</li> </ul> </li> </ul>"},{"location":"services/web/#2-nginx-linux","title":"2. Nginx (Linux)","text":"<p>Config File: Usually <code>/etc/nginx/nginx.conf</code></p> <ul> <li>Hide Version:<ul> <li>Add to the <code>http</code> block: <pre><code>server_tokens off;\n</code></pre></li> </ul> </li> <li>Block hidden files (like .git): <pre><code>location ~ /\\. {\n    deny all;\n}\n</code></pre></li> </ul>"},{"location":"services/web/#3-iis-windows","title":"3. IIS (Windows)","text":"<p>Manage via \"Internet Information Services (IIS) Manager\"</p> <ul> <li>Disable Directory Browsing:<ul> <li>Click the specific Site -&gt; Double click Directory Browsing -&gt; Click Disable on the right.</li> </ul> </li> <li>Remove HTTP Headers (X-Powered-By):<ul> <li>Click HTTP Response Headers -&gt; Remove <code>X-Powered-By</code>.</li> </ul> </li> <li>Application Pools (Isolation):<ul> <li>Ensure each website runs in its own Application Pool. If one gets hacked, the others survive.</li> </ul> </li> </ul>"}]}